!function(a,b,c,d,e){"use strict";b.Map.addInitHook(function(){this.options.controlBox={list:[],updateOnResize:!1}}),b.Control.Box=b.Control.ButtonGroup.extend({options:{width:0,height:0,scroll:!1,scrollX:!1,scrollY:!1,header:"",icon:"plus",className:"",cornerButtons:{pin:{icon:"thumb-tack",color:"",functionName:"pin",title:"Pin the box"},unpin:{icon:"chevron-left",color:"",functionName:"unpin",title:"Unpin the box"},extend:{icon:"plus",color:"",functionName:"extendBox",title:"Extend"},diminish:{icon:"minus",color:"",functionName:"diminishBox",title:"Diminish"},close:{icon:"close",color:"red",functionName:"close",title:"Close"}},open:!1,onClose:null,onOpen:null,singleBoxMode:!1,extendable:!1,extended:!1,pinable:!1,pined:!1,noMargin:!1,hiddenWhenClosed:!1,updateOnResize:!1},initialize:function(c){a.extend(c,{className:c.className,onClickObj:{},separateButtons:!1,horizontal:!0,buttons:[{icon:c.icon,title:c.header,onClick:this.open,context:this}]}),c.className="leaflet-control-boxmenu "+(c.hiddenWhenClosed?"hidden-when-closed ":"")+c.className,b.Control.ButtonGroup.prototype.initialize.call(this,c),b.Util.setOptions(this,c),this.pos=this.options.position,this.vertPos=this.options.position.indexOf("top")>-1?"top":"bottom",this.horiPos=this.options.position.indexOf("left")>-1?"left":this.options.position.indexOf("right")>-1?"right":"center",this.options.cornerButtons.unpin.icon="chevron-"+("bottomcenter"==this.pos?"down":this.horiPos),this._maxWidth=0,this._maxExtendedWidth=0,this._initializing=!0,this._open=!1,this._extended=this.options.extended,this._pined=this.options.pined,this.contentsContainers=[];var d,e,f=["singleBoxMode","extendable","pinable","noMargin"],g=function(a){return function(){return a}};for(d=0;d<f.length;d++)e=f[d],"boolean"==typeof this.options[e]&&(this.options[e]=g(this.options[e]))},onAdd:function(d){b.Control.ButtonGroup.prototype.onAdd.call(this,d),this.$container=a(this._container),b.DomEvent.disableClickPropagation(this._container),b.DomEvent.on(this._container,"mousewheel",b.DomEvent.stopPropagation);var e=0,f=0;this.options.position.indexOf("top")>-1&&(e+=c.Hammer.DIRECTION_UP,f+=c.Hammer.DIRECTION_DOWN),this.options.position.indexOf("bottom")>-1&&(e+=c.Hammer.DIRECTION_DOWN,f+=c.Hammer.DIRECTION_UP),this.options.position.indexOf("left")>-1&&(e+=c.Hammer.DIRECTION_LEFT,f+=c.Hammer.DIRECTION_RIGHT),this.options.position.indexOf("right")>-1&&(e+=c.Hammer.DIRECTION_RIGHT,f+=c.Hammer.DIRECTION_LEFT);var g=new c.Hammer.Manager(this._container,{recognizers:[[c.Hammer.Swipe,{event:"close",direction:e}],[c.Hammer.Swipe,{event:"open",direction:f}]]});g.on("close",a.proxy(this.close,this)),g.on("open",a.proxy(this.open,this)),this.$header=a("<div>").addClass("leaflet-control-boxmenu-header").append(a("<i>").addClass("fa fa-"+this.options.icon).on("click",a.proxy(this.close,this))).append(this.options.header).prependTo(this._container);var h=[],i=this;return a.each(this.options.cornerButtons,function(b,c){h.push({id:b,title:c.title,icon:c.icon,hidden:!1,hoverColor:c.color,onClick:a.proxy(i[c.functionName],i)})}),this.buttonGroup=new b.Control.ButtonGroup({horizontal:!0,small:!0,equalWidth:!0,className:"",buttons:h}),this.$header.append(this.buttonGroup._container),this.$contentContainer=this.addContentsContainer(this.options),this._container},addTo:function(c){return b.Control.prototype.addTo.call(this,c),c.options.controlBox.list.push(this),this.options.updateOnResize&&!c.options.controlBox.updateOnResize&&(c.on("resize",function(){a.each(this.options.controlBox.list,function(a,b){b.options.updateOnResize&&b._update()})}),c.options.controlBox.updateOnResize=!0),this.mapContainer=a(c.getContainer()).parent(),this._initializing=!1,this.options.open?this.open():this._update(),this},addContentsContainer:function(b){b=a.extend({onlyExtended:!1,neverExtended:!1,scroll:!1,scrollX:!1,scrollY:!1,width:this.options.width},b);var c=a("<div>").addClass("leaflet-control-boxmenu-container "+("auto"==b.height?"auto":"fixed")+" "+(b.onlyExtended?"only-extended ":"")+(b.neverExtended?"never-extended ":"")+(b.scroll?"scroll ":"")+(b.scrollX?"scroll-x ":"")+(b.scrollY?"scroll-y ":"")+(b.className||"")).width(b.width+"px").css("max-width",b.width+"px").data("control-box-contents-options",b).appendTo(this._container);return"auto"!=b.height&&c.height(b.height+"px").css("max-height",b.height+"px"),b.onlyExtended||(this._maxWidth=Math.max(this._maxWidth,b.width)),b.neverExtended||(this._maxExtendedWidth=Math.max(this._maxExtendedWidth,b.width)),this.contentsContainers.push(c),this._map&&this._update(),c},close:function(){this._open&&(this._pined&&this.unpin(),this.showSiblingsOnClose&&this.$container.parent().siblings().find(".leaflet-control-boxmenu").show(),this.showSiblingsOnClose=!1,this._map.thaw(),this._open=!1,this.$container.removeClass("open"),this.options.onClose&&this.options.onClose(this))},open:function(){this._findOtherControls("left"),this._initializing||this._open||((this.options.singleBoxMode()||this.options.MANGLER)&&(this.showSiblingsOnClose=!0),this._open=!0,this.$container.addClass("open"),this._update(),this.options.onOpen&&this.options.onOpen(this))},extendBox:function(){this._extended=!0,this._update()},diminishBox:function(){this._extended=!1,this._update()},pin:function(){if(this._next=this.$container.next(),this._parent=this.$container.parent(),this._width=this.$container.outerWidth(),this._height=this.$container.outerHeight(),this.$container.detach(),this.mapContainer.prepend(this.$container),this.$container.addClass("pin-"+this.pos),"bottomcenter"==this.pos){this._map.bottomMargin(this._height+2+"px"),this._map.panBy([0,-(this._height+2)/2],{animate:!1});var b=this._findOtherControls("left right","top");a.each(b,function(a,b){b.options.pinable()&&b._update()})}else this._map._setMargin(this.horiPos,this._width+2+"px");this._pined=!0,this._update()},unpin:function(){if(this.$container.detach(),this._next.length?this._next.before(this.$container):this._parent.append(this.$container),this.$container.removeClass("pin-"+this.pos),"bottomcenter"==this.pos){this._map.bottomMargin(0),this._map.panBy([0,(this._height+2)/2],{animate:!1});var b=this._findOtherControls("left right","top");a.each(b,function(a,b){b.options.pinable()&&b._update()})}else this._map._setMargin(this.horiPos,0);this._pined=!1,this._update()},_showButton:function(a,b){this.buttonGroup._showButton(this.buttonGroup.getButton(a),b)},_update:function(){var b=this.options.pinable(),c=this.options.extendable();!b&&this._pined&&this.close(),this._showButton("pin",b&&!this._pined),this._showButton("unpin",b&&this._pined),this._showButton("extend",c&&!this._extended),this._showButton("diminish",c&&this._extended),this.$header.css({"max-width":this._extended?this._maxExtendedWidth:this._maxWidth,"padding-right":a(this.buttonGroup._container).width()+"px"}),"top"==this.vertPos&&b&&this.$container.css("padding-bottom",this._pined?this._map.bottomMargin():0),this.$container.toggleClass("no-margin",this.options.noMargin()),this.$container.toggleClass("extended",c&&this._extended)},_findOtherControls:function(b,c){var d=[],e=this;return b=(b||"left center right").split(" "),c=(c||"top bottom").split(" "),a.each(this._map.options.controlBox.list,function(a,f){if(f!==e)for(var g=0;g<b.length;g++)if(f.horiPos==b[g])for(var h=0;h<c.length;h++)if(f.vertPos==c[h]){d.push(f);break}}),d}})}(jQuery,L,this,document);